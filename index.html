<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Wildfire Story: Pacific Palisades & USA Fires</title>
  
  <!-- Leaflet CSS & JS for the interactive map -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- D3.js for slider functionality -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <!-- Google Fonts for Typography -->
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Merriweather&display=swap" rel="stylesheet">
  
  <style>
    /* Base Styles */
    body {
      font-family: 'Merriweather', serif;
      margin: 0;
      padding: 0;
      background: #F4511E; /* Dark orange base */
      color: #333;
      line-height: 1.6;
      overflow-x: hidden;
      perspective: 1000px; /* 3D effect */
      position: relative;
    }
    body::before { /* Gradient overlay */
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(244, 81, 30, 0.8), rgba(255, 204, 188, 0.2));
      z-index: -2;
    }
    body::after { /* Floating particles */
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(0, 0, 0, 0.1) 1px, transparent 1px);
      background-size: 20px 20px;
      animation: floatParticles 20s linear infinite;
      z-index: -1;
      opacity: 0.3;
    }
    @keyframes floatParticles {
      0% { transform: translateY(0) translateZ(-100px); }
      100% { transform: translateY(-100vh) translateZ(50px); }
    }
    p {
      margin: 16px 0;
    }
    h1, h2 {
      font-family: 'Oswald', sans-serif;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin: 20px 0 16px;
      padding: 0;
      color: #D84315;
      position: relative;
      text-shadow: 0 0 10px rgba(244, 81, 30, 0.5); /* Glowing effect */
    }
    h1::after, h2::after { /* Smoke trail */
      content: '';
      position: absolute;
      top: -10px;
      left: 0;
      width: 100%;
      height: 20px;
      background: rgba(244, 81, 30, 0.2);
      filter: blur(10px);
      animation: smokeTrail 3s infinite;
    }
    @keyframes smokeTrail {
      0% { transform: translateX(-20px); opacity: 0.5; }
      100% { transform: translateX(20px); opacity: 0; }
    }
    
    /* Container */
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      transform-style: preserve-3d;
    }
    
    /* Section Styles (Glassmorphic with 3D, no tilt) */
    .section {
      margin: 40px 0;
      padding: 30px;
      border-radius: 15px;
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 204, 188, 0.4);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
      transform: translateZ(20px);
      transition: transform 0.5s ease, opacity 0.5s ease;
      clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
      animation: burnReveal 1.5s ease forwards;
    }
    .section:hover {
      transform: translateZ(30px); /* Depth only, no tilt */
    }
    @keyframes burnReveal {
      0% { clip-path: polygon(0 0, 0 0, 0 100%, 0 100%); opacity: 0; }
      100% { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); opacity: 1; }
    }
    
    /* Slider Styles */
    .slider-container {
      text-align: center;
      margin-bottom: 30px;
      position: relative;
    }
    .slider-container input[type=range] {
      width: 80%;
      max-width: 500px;
      -webkit-appearance: none;
      appearance: none;
      height: 8px;
      background: linear-gradient(to right, #FFCCBC, #F4511E);
      border-radius: 4px;
      outline: none;
      margin: 20px auto;
      position: relative;
    }
    .slider-container input[type=range]::before { /* Timeline markers */
      content: '';
      position: absolute;
      top: -10px;
      left: 0;
      width: 100%;
      height: 20px;
      background: linear-gradient(to right, transparent 0%, #F4511E 2%, transparent 4%, transparent 24%, #F4511E 26%, transparent 28%, transparent 48%, #F4511E 50%, transparent 52%, transparent 72%, #F4511E 74%, transparent 76%);
      pointer-events: none;
    }
    .slider-container input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 24px;
      height: 36px;
      background: #F4511E;
      clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
      cursor: pointer;
      box-shadow: 0 0 15px rgba(244, 81, 30, 0.8);
      transition: transform 0.3s ease;
    }
    .slider-container input[type=range]::-moz-range-thumb {
      width: 24px;
      height: 36px;
      background: #F4511E;
      clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
      cursor: pointer;
      box-shadow: 0 0 15px rgba(244, 81, 30, 0.8);
      transition: transform 0.3s ease;
    }
    
    /* Image Display */
    .image-display {
      text-align: center;
      position: relative;
    }
    .image-display img {
      width: 100%;
      max-height: 500px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(244, 81, 30, 0.5);
      border: 2px solid rgba(244, 81, 30, 0.7);
      transition: filter 0.5s ease;
    }
    .image-display img.active {
      filter: brightness(1.2) contrast(1.1); /* Burn transition */
    }
    
    /* Narrative */
    .narrative {
      font-size: 1.1em;
      margin-top: 20px;
      opacity: 0;
      animation: fadeText 2s ease forwards 0.5s;
    }
    @keyframes fadeText {
      to { opacity: 1; }
    }
    .narrative blockquote {
      color: #FF8A65;
      font-style: italic;
      border-left: 4px solid #F4511E;
      padding-left: 20px;
      margin: 20px 0;
      position: relative;
    }
    .narrative blockquote::before {
      content: '';
      position: absolute;
      left: -10px;
      top: 0;
      width: 5px;
      height: 100%;
      background: linear-gradient(to bottom, #F4511E, transparent);
      animation: glowLine 2s infinite;
    }
    @keyframes glowLine {
      0% { opacity: 0.5; }
      50% { opacity: 1; }
      100% { opacity: 0.5; }
    }
    
    /* Map */
    #firms-map {
      width: 100%;
      height: 500px;
      border-radius: 10px;
      margin-top: 30px;
      border: 2px solid rgba(244, 81, 30, 0.7);
      position: relative;
      overflow: hidden;
    }
    #firms-map::before { /* Heat-map overlay */
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, rgba(244, 81, 30, 0.3), transparent);
      pointer-events: none;
      z-index: 1;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .slider-container input[type=range] {
        width: 95%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Section 1: Satellite Image Slider for Pacific Palisades & Malibu -->
    <div class="section" id="satellite-section">
      <h1>Wildfire Impact in Pacific Palisades & Malibu</h1>
      <p>
        These maps chronicle the evolution of a catastrophic wildfire that devastated Pacific Palisades and Malibu between January 2 and February 21, 2025. Use the slider below to explore satellite images captured on these key dates. Although our technical analysis employs DNBR (Delta Normalized Burn Ratio) values, here they serve as textual context to help illustrate the visual transformation—from a lush, vibrant landscape to one scarred by fire and finally showing early signs of recovery.
      </p>
      <div class="slider-container">
        <input type="range" id="imageSlider" min="0" max="3" step="1" value="0">
        <p id="sliderLabel">Date: January 2, 2025</p>
      </div>
      <div class="image-display">
        <img id="satelliteImage" src="SWIR_02012025.jpg" alt="Satellite Image - January 2, 2025">
      </div>
      <div class="narrative" id="analysisText">
        <p>DNBR: Minimal damage.</p>
      </div>
      <div class="narrative">
        <p>
          Between January 2 and February 21, 2025, the coastal regions of Pacific Palisades and Malibu underwent a profound transformation due to a catastrophic wildfire. On January 2, satellite imagery depicted a pristine landscape, rich in vibrant vegetation and a picturesque coastline. However, as the fire ignited and spread, the environment deteriorated rapidly. DNBR values, serving as our analytical benchmark, indicated a gradual escalation in burn severity.
        </p>
        <blockquote>
          "By mid-January, initial signs of damage became apparent, foreshadowing the extensive destruction that was to follow."
        </blockquote>
        <p>
          The imagery captured on January 30 starkly revealed the devastation—the once-thriving ecosystem had largely been supplanted by charred remnants, and the intensity of the burns was unmistakable. Yet, amid this widespread loss, the final image from February 21 unveiled a glimmer of hope. In certain areas, early signs of regrowth emerged, suggesting nature’s resilience and the potential for recovery.
        </p>
      </div>
    </div>
    
    <!-- Section 2: USA FIRMS Map for Active Wildfires -->
    <div class="section" id="firms-section">
      <h2>Wildfires Across the USA</h2>
      <p>
        Wildfires continue to threaten communities across the United States. The interactive map below, based on a locally clipped FIRMS dataset joined with county names, displays active wildfire events. Each marker indicates the county where the fire was detected, offering valuable insight into the local impacts within the broader national crisis.
      </p>
      <div id="firms-map"></div>
      <div class="narrative">
        <p>
          Focusing on county-level data allows us to better understand the localized effects of wildfires. This national view complements the detailed analysis of the Pacific Palisades and Malibu event, providing a comprehensive perspective on wildfire impacts across the country.
        </p>
      </div>
    </div>
  </div>
  
  <script>
    // -------------------------------
    // Section 1: Satellite Image Slider
    // -------------------------------
    const images = [
      { date: 'January 2, 2025', src: 'SWIR_02012025.jpg', dnbr: 'DNBR: Minimal damage.' },
      { date: 'January 12, 2025', src: 'SWIR_12012025.jpg', dnbr: 'DNBR: Moderate burning.' },
      { date: 'February 1, 2025', src: 'SWIR_01022025.jpg', dnbr: 'DNBR: Severe burn observed.' },
      { date: 'February 21, 2025', src: 'SWIR_21022025.jpg', dnbr: 'DNBR: Early recovery signs.' }
    ];
    
    const slider = document.getElementById('imageSlider');
    const satelliteImage = document.getElementById('satelliteImage');
    const sliderLabel = document.getElementById('sliderLabel');
    const analysisText = document.getElementById('analysisText');
    
    slider.addEventListener('input', function() {
      const index = parseInt(this.value);
      satelliteImage.classList.remove('active');
      setTimeout(() => {
        satelliteImage.src = images[index].src;
        satelliteImage.classList.add('active');
      }, 100); // Brief delay for transition
      sliderLabel.textContent = `Date: ${images[index].date}`;
      analysisText.innerHTML = `<p>${images[index].dnbr}</p>`;
    });
    
    // -------------------------------
    // Section 2: USA FIRMS Map
    // -------------------------------
    const firmsMap = L.map('firms-map').setView([37.5, -95], 4);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: '© CartoDB'
    }).addTo(firmsMap);
    
    const firmsDataURL = 'FIRMS_COUNTIES.geojson';
    fetch(firmsDataURL)
      .then(response => response.json())
      .then(data => {
        L.geoJSON(data, {
          pointToLayer: (feature, latlng) => {
            return L.circleMarker(latlng, {
              radius: 6,
              fillColor: '#F4511E',
              color: '#F4511E',
              weight: 1,
              opacity: 0.9,
              fillOpacity: 0.7,
              className: 'fire-marker'
            });
          },
          onEachFeature: (feature, layer) => {
            const county = feature.properties.county_name || feature.properties.name || 'Unknown County';
            layer.bindPopup(`<b>County:</b> ${county}`);
            layer.on('mouseover', () => layer.setStyle({ radius: 8, fillOpacity: 1 }));
            layer.on('mouseout', () => layer.setStyle({ radius: 6, fillOpacity: 0.7 }));
          }
        }).addTo(firmsMap);
      })
      .catch(error => console.error('Error loading FIRMS_COUNTIES.geojson:', error));

    // Add CSS for animated smoke markers
    const style = document.createElement('style');
    style.textContent = `
      .fire-marker {
        animation: smokeRise 2s infinite;
      }
      @keyframes smokeRise {
        0% { transform: translateY(0); opacity: 0.7; }
        50% { transform: translateY(-10px); opacity: 1; }
        100% { transform: translateY(-20px); opacity: 0; }
      }
    `;
    document.head.appendChild(style);

    // Scroll-triggered section animations
    window.addEventListener('scroll', () => {
      document.querySelectorAll('.section').forEach(section => {
        const rect = section.getBoundingClientRect();
        if (rect.top < window.innerHeight * 0.75) {
          section.style.animation = 'burnReveal 1.5s ease forwards';
        }
      });
    });
  </script>
</body>
</html>
